!function(t){function e(e){function i(t){var e=new Image;e.onload=e.onerror=function(){t(2==e.height)},e.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}var n=this,o=e&&e.cl||"optimized";this.images=[],this.settings={proxy:e&&e.proxy||!1,WebP:!1,forceRatio:e&&e.forceRatio||!1,cl:o,lazyCl:e&&e.lazyCl||o,resizeCl:e&&e.resizeCl||o},this.handleVisibility=function(){n.images&&n.images.length||t.removeEventListener("scroll",n.handleVisibility);for(var e=0;e<n.images.length;e++){var i=n.images[e];n.elementInViewport(i)&&n.loadImage(i,function(){for(var t=0;t<n.images.length;t++)i===n.images[t]&&n.images.splice(t,1)})}},i(function(t){n.settings.WebP=t})}e.prototype.setWebPSrc=function(t){return t.replace(/\.(png|jpe?g|gif)/gi,".$1.webp")},e.prototype.loadImage=function(t,e){var i=this,n=new Image,o=t.getAttribute("data-src"),r=t.getAttribute("data-bg");o&&(i.settings.WebP&&(o=this.setWebPSrc(o)),n.onload=function(){t.parent?t.parent.replaceChild(n,t):t.src=o,i.settings.forceRatio||(t.style.height="auto"),e&&"function"==typeof e?e():null},n.src=this.getImgSrc(o,t.offsetWidth)),r&&(this.settings.WebP&&(r=this.setWebPSrc(r)),t.style.backgroundImage="url("+this.getImgSrc(r,t.offsetWidth)+")")},e.prototype.getImgSrc=function(t,e){return this.settings.proxy?["/",this.settings.proxy,e,t].join("/"):t},e.prototype.elementInViewport=function(e){var i=e.getBoundingClientRect();return i.top>=0&&i.left>=0&&i.top<=(t.innerHeight||document.documentElement.clientHeight)},e.prototype.imgSetHeight=function(t){var e=t.offsetWidth,i=t.getAttribute("data-ratio")?t.getAttribute("data-ratio"):1;if(1!==i){var n=i.split(":");n.length>1&&(i=parseFloat(n[1]||1)/parseFloat(n[0]||1))}t.style.height=e*i+"px"},e.prototype.init=function(){for(var e=document.querySelectorAll("."+this.settings.cl),i=0;i<e.length;i++)this.imgSetHeight(e[i]),this.images.push(e[i]);return t.addEventListener("scroll",this.handleVisibility),this.handleVisibility(),this},"function"==typeof define?define("proximity",e):t.Proximity=e}(window);